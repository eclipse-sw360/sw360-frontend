// Copyright (C) Siemens AG, 2023. Part of the SW360 Frontend Project.

// This program and the accompanying materials are made
// available under the terms of the Eclipse Public License 2.0
// which is available at https://www.eclipse.org/legal/epl-2.0/

// SPDX-License-Identifier: EPL-2.0
// License-Filename: LICENSE

'use client'

import { useTranslations } from 'next-intl'
import { Dispatch, SetStateAction, ReactNode } from 'react'

import { Vulnerability } from '@/object-types'

function VulnerabilityDetail({
    payload,
    setPayload,
}: {
    payload: Vulnerability
    setPayload: Dispatch<SetStateAction<Vulnerability>>
}) : ReactNode {
    const t = useTranslations('default')

    const handleChange = (e: React.ChangeEvent<HTMLSelectElement | HTMLInputElement | HTMLTextAreaElement>) => {
        setPayload((prev) => ({ ...prev, [e.target.name]: e.target.value }))
    }

    return (
        <>
            <div className='row mb-4 mx-0'>
                <div className='row header mb-2 pb-2 px-2'>
                    <h6>{t('Vulnerability Detail')}</h6>
                </div>
                <div className='row'>
                    <div className='col-lg-6'>
                        <label htmlFor='vulnerabilityDetail.externalId' className='form-label fw-medium'>
                            {t('External Id')}{' '}
                            <span className='text-red' style={{ color: '#F7941E' }}>
                                *
                            </span>
                        </label>
                        <input
                            type='text'
                            name='externalId'
                            value={payload.externalId}
                            onChange={handleChange}
                            className='form-control'
                            id='vulnerabilityDetail.externalId'
                            placeholder={t('Enter Vulnerability External Id')}
                            required
                        />
                    </div>
                    <div className='col-lg-6'>
                        <label htmlFor='vulnerabilityDetail.title' className='form-label fw-medium'>
                            {t('Title')}
                        </label>
                        <input
                            title='External Id'
                            type='text'
                            name='title'
                            value={payload.title}
                            onChange={handleChange}
                            className='form-control'
                            id='vulnerabilityDetail.title'
                            placeholder={t('Enter Vulnerability Title')}
                        />
                    </div>
                    <hr className='my-3' />
                </div>

                <div className='row'>
                    <label htmlFor='vulnerabilityDetail.description' className='form-label fw-medium'>
                        {t('Description')}
                    </label>
                    <textarea
                        className='form-control'
                        name='description'
                        value={payload.description}
                        onChange={handleChange}
                        id='vulnerabilityDetail.description'
                        placeholder={t('Enter Vulnerability Description')}
                        style={{ height: '100px' }}
                    ></textarea>
                    <hr className='my-3' />
                </div>
                <div className='row'>
                    <div className='col-lg-6'>
                        <label htmlFor='vulnerabilityDetail.priority' className='form-label fw-medium'>
                            {t('Priority')}
                        </label>
                        <input
                            type='text'
                            name='priority'
                            value={payload.priority}
                            onChange={handleChange}
                            className='form-control'
                            id='vulnerabilityDetail.priority'
                            placeholder={t('Enter Priority')}
                        />
                    </div>
                    <div className='col-lg-6'>
                        <label htmlFor='vulnerabilityDetail.priorityText' className='form-label fw-medium'>
                            {t('Priority Text')}
                        </label>
                        <input
                            type='text'
                            name='priorityText'
                            value={payload.priorityText}
                            onChange={handleChange}
                            className='form-control'
                            id='vulnerabilityDetail.priorityText'
                            placeholder={t('Enter Priority Text')}
                        />
                    </div>
                    <hr className='my-3' />
                </div>
                <div className='row'>
                    <div className='col-lg-6'>
                        <label htmlFor='vulnerabilityDetail.action' className='form-label fw-medium'>
                            {t('Action')}
                        </label>
                        <input
                            type='text'
                            name='action'
                            value={payload.action}
                            onChange={handleChange}
                            className='form-control'
                            id='vulnerabilityDetail.action'
                            placeholder={t('Enter Action')}
                        />
                    </div>
                    <div className='col-lg-6'>
                        <label htmlFor='vulnerabilityDetail.legalNotice' className='form-label fw-medium'>
                            {t('Legal Notice')}
                        </label>
                        <input
                            type='text'
                            name='legalNotice'
                            value={payload.legalNotice}
                            onChange={handleChange}
                            className='form-control'
                            id='vulnerabilityDetail.legalNotice'
                            placeholder={t('Enter Legal Notice')}
                        />
                    </div>
                    <hr className='my-3' />
                </div>
                <div className='row'>
                    <div className='col-lg-6'>
                        <label htmlFor='vulnerabilityDetail.cwe' className='form-label fw-medium'>
                            {t('CWE')}
                        </label>
                        <div className='input-group'>
                            <span className='input-group-text' id='cwe-addon'>
                                {t('CWE')}-
                            </span>
                            <input
                                type='text'
                                name='cwe'
                                value={payload.cwe}
                                onChange={handleChange}
                                className='form-control'
                                id='vulnerabilityDetail.cwe'
                                placeholder={t('Enter Cwe')}
                            />
                        </div>
                    </div>
                    <div className='col-lg-6'>
                        <label htmlFor='vulnerabilityDetail.extendedDescription' className='form-label fw-medium'>
                            {t('Extended Description')}
                        </label>
                        <input
                            type='text'
                            name='extendedDescription'
                            value={payload.extendedDescription}
                            onChange={handleChange}
                            className='form-control'
                            id='vulnerabilityDetail.extendedDescription'
                            placeholder={t('Enter Extended Description')}
                        />
                    </div>
                    <hr className='my-3' />
                </div>
                <div className='row'>
                    <div className='col-lg-6'>
                        <label htmlFor='vulnerabilityDetail.cvssScore' className='form-label fw-medium'>
                            {t('Cvss Score')}{' '}
                            <span className='text-red' style={{ color: '#F7941E' }}>
                                *
                            </span>
                        </label>
                        <input
                            type='number'
                            step='0.01'
                            min={0}
                            name='cvss'
                            value={payload.cvss}
                            onChange={handleChange}
                            className='form-control'
                            id='vulnerabilityDetail.cvssScore'
                            placeholder={t('Enter Cvss Score')}
                            required
                        />
                    </div>
                    <div className='col-lg-3'>
                        <label htmlFor='vulnerabilityDetail.cvssDate' className='form-label fw-medium'>
                            {t('CVSS Date')}
                        </label>
                        <input
                            type='text'
                            name='cvssDate'
                            value={payload.cvssDate}
                            onChange={handleChange}
                            className='form-control'
                            aria-label='CVSS'
                            id='vulnerabilityDetail.cvssDate'
                            placeholder={t('CVSS Date YYYY-MM-DD')}
                            onFocus={(e) => {
                                e.target.type = 'date'
                            }}
                            onBlur={(e) => {
                                e.target.type = 'text'
                            }}
                        />
                    </div>
                    <div className='col-lg-3'>
                        <label htmlFor='vulnerabilityDetail.cvssTime' className='form-label fw-medium'>
                            {t('CVSS Time')}
                        </label>
                        <input
                            type='time'
                            step='1'
                            name='cvssTime'
                            value={payload.cvssTime}
                            onChange={handleChange}
                            className='form-control'
                            aria-label='CVSS Time'
                            id='vulnerabilityDetail.cvssTime'
                        />
                    </div>
                    <hr className='my-3' />
                </div>
                <div className='row'>
                    <div className='col-lg-3'>
                        <label htmlFor='vulnerabilityDetail.publishDate' className='form-label fw-medium'>
                            {t('Publish Date')}
                        </label>
                        <input
                            type='text'
                            name='publishDate'
                            value={payload.publishDate}
                            onChange={handleChange}
                            className='form-control'
                            aria-label='Publish Date YYYY-MM-DD'
                            id='vulnerabilityDetail.publishDate'
                            placeholder={t('Publish Date YYYY-MM-DD')}
                            onFocus={(e) => {
                                e.target.type = 'date'
                            }}
                            onBlur={(e) => {
                                e.target.type = 'text'
                            }}
                        />
                    </div>
                    <div className='col-lg-3'>
                        <label htmlFor='vulnerabilityDetail.publishTime' className='form-label fw-medium'>
                            {t('Publish Time')}
                        </label>
                        <input
                            type='time'
                            step='1'
                            name='publishTime'
                            value={payload.publishTime}
                            onChange={handleChange}
                            className='form-control'
                            id='vulnerabilityDetail.publishTime'
                        />
                    </div>
                    <div className='col-lg-3'>
                        <label htmlFor='vulnerabilityDetail.lastExternalUpdateDate' className='form-label fw-medium'>
                            {t('Last External Update Date')}
                        </label>
                        <input
                            type='text'
                            name='lastExternalUpdateDate'
                            value={payload.lastExternalUpdateDate}
                            onChange={handleChange}
                            className='form-control'
                            aria-label='last.local'
                            id='vulnerabilityDetail.lastExternalUpdateDate'
                            placeholder={t('Last External Update Date YYYY-MM-DD')}
                            onFocus={(e) => {
                                e.target.type = 'date'
                            }}
                            onBlur={(e) => {
                                e.target.type = 'text'
                            }}
                        />
                    </div>
                    <div className='col-lg-3'>
                        <label htmlFor='vulnerabilityDetail.lastExternalUpdateTime' className='form-label fw-medium'>
                            {t('Last External Update Time')}
                        </label>
                        <input
                            type='time'
                            step='1'
                            name='lastExternalUpdateTime'
                            value={payload.lastExternalUpdateTime}
                            onChange={handleChange}
                            className='form-control'
                            aria-label='last.update'
                            id='vulnerabilityDetail.lastExternalUpdateTime'
                        />
                    </div>
                    <hr className='my-3' />
                </div>
            </div>
        </>
    )
}

export default VulnerabilityDetail
